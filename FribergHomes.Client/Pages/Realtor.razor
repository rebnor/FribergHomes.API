@* Author: Reb 2024-04-30
    // TODO: Behövs denna sida? Eftersom man hittar alla mäklare genom AgencyPage redan? 
*@
@page "/realtor"
@using FribergHomes.Client.DTOs
@using FribergHomes.Client.Services.Interfaces
@using FribergHomes.Client.Components
@inject IRealtor realtorService

<h1>Mäklare</h1>

<hr />

<div class="row">
    @if (RealtorDtoList != null)
    {
        <GetList ObjectType="Realtor" TItem="RealtorDTO"></GetList>
    }
</div>

@* // TODO: Se över om denna ska vara med, då Id inte är en int längre*@
@* <h3>Sök mäklare via Byrå:</h3>
<form @onsubmit="SubmitAgency">
    <input type="text" @bind="agency" />
    <button type="submit">Hämta mäklare från byrå</button>
</form>

@if (RealtorDtoList != null)
{
    foreach (var realtor in RealtorDtoList)
    {
        <GetById ObjectId="@realtor.Id" ObjectType="Realtor" />
    }
} *@




@code {
    private RealtorDTO RealtorDto { get; set; }
    private List<RealtorDTO> RealtorDtoList;

    private int realtorId;
    private string agency;

    protected override async Task OnInitializedAsync()
    {
        await ShowAllRealtors();    
    }
    private async void SubmitAgency()
    {
        RealtorDtoList = await realtorService.GetRealtorsByAgencyAsync(agency);
        StateHasChanged();
    }

    private async Task ShowAllRealtors()
    {
        RealtorDtoList = await realtorService.GetAllRealtorsAsync();
        StateHasChanged();
    }
}
